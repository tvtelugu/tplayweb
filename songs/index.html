<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube Music Style Player</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Parkinson&display=swap" rel="stylesheet">
    <style>
        /* General Reset and Layout */
        body, html {
            margin: 0;
            padding: 0;
            font-family: 'Parkinsans', sans-serif;
            background-color: #121212;
            color: white;
            height: 100%;
            overflow: hidden;
        }

        /* Loader Styles */
        .loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #121212;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .loader .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Hide loader when page is loaded */
        .hide-loader {
            display: none;
        }

        /* Main Layout */
        .container {
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        /* Header */
        #header {
            display: flex;
            align-items: center;
            padding: 15px;
            background-color: #1F1F1F;
            justify-content: space-between;
        }

        /* Logo Container */
        #logo-container {
            width: 30px;
            height: 30px;
        }

        /* Page Logo */
        #page-logo {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        /* Search Bar */
        #search-container {
            display: flex;
            align-items: center;
            background-color: #333;
            border-radius: 20px;
            padding: 5px 15px;
            width: 200px;
            transition: all 0.3s ease;
        }

        #search-bar {
            background: none;
            border: none;
            color: white;
            font-size: 14px;
            outline: none;
            padding: 5px;
            width: 150px;
        }

        #search-btn {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
        }

        /* Main Player */
        #player-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            flex: 1;
            overflow-y: auto;
        }

        /* Album Image */
        #album-poster {
            width: 250px;
            height: 250px;
            background-size: cover;
            background-position: center;
            border-radius: 15px;
            margin-bottom: 15px;
            position: relative;
        }

        /* Lyrics Section */
        #lyrics-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            text-align: center;
            color: #bbb;
            font-size: 14px;
            z-index: 10;
            padding: 15px;
            background-color: rgba(0, 0, 0, 0.5);
            border-radius: 15px;
        }

        .highlight {
            color: #FF4081;
            font-weight: bold;
        }

        /* Song Info */
        #song-info {
            text-align: center;
            margin-bottom: 20px;
        }

        #song-name {
            font-size: 22px;
            font-weight: bold;
            margin: 10px 0;
        }

        #song-artist {
            font-size: 16px;
            color: #999;
        }

        #album-name {
            font-size: 14px;
            color: #888;
            margin-top: 5px;
        }

        /* Song List */
        #song-list {
            width: 100%;
            padding: 10px;
            background-color: #1F1F1F;
            border-radius: 10px;
            margin-bottom: 20px;
            border: none;
            color: white;
        }

        /* Controls */
        #controls {
            display: flex;
            justify-content: space-between;
            width: 100%;
            margin-top: 20px;
        }

        #controls button {
            background: none;
            border: none;
            color: white;
            font-size: 40px;
            cursor: pointer;
        }

        /* Progress Bar */
        #progress-bar {
            width: 100%;
            height: 10px;
            background-color: #333;
            border-radius: 5px;
            margin: 10px 0;
            outline: none;
            cursor: pointer;
        }

        #progress-bar::-webkit-slider-thumb {
            background: #FF4081;
            border: none;
            height: 20px;
            width: 20px;
            border-radius: 50%;
            cursor: pointer;
        }

        /* Quality Dropdown */
        #quality-select {
            background: #333;
            color: white;
            border: none;
            padding: 8px;
            border-radius: 5px;
            font-size: 16px;
            margin-top: 15px;
        }

        /* Shuffle and Download Icon */
        #shuffle-btn {
            font-size: 30px;
            color: white;
            cursor: pointer;
            margin-right: 20px;
        }

        #download-btn {
            font-size: 30px;
            color: white;
            cursor: pointer;
        }

        /* Mobile Responsiveness */
        @media (max-width: 600px) {
            #search-container {
                width: 150px;
            }

            #song-list {
                width: 90%;
            }

            #song-name {
                font-size: 18px;
            }

            #song-artist {
                font-size: 14px;
            }

            #controls button {
                font-size: 30px;
            }

            #quality-select {
                font-size: 14px;
            }

            #album-poster {
                width: 200px;
                height: 200px;
            }

            #download-btn {
                font-size: 20px;
            }
        }

        /* Hide audio element */
        #audio {
            display: none;
        }
    </style>
</head>
<body>

    <!-- Loader -->
    <div class="loader" id="loader">
        <div class="spinner"></div>
    </div>

    <div class="container" id="content" class="hide-loader">

        <!-- Header: Page Logo & Search Bar -->
        <div id="header">
            <div id="logo-container">
                <img src="https://tvtelugu.github.io/images/tvtelugu.ico" alt="Logo" id="page-logo" />
            </div>
            <div id="search-container">
                <input type="text" id="search-bar" placeholder="Search..." onkeyup="searchSongs(this.value)" />
                <button id="search-btn">
                    <i class="material-icons">search</i>
                </button>
            </div>
        </div>

        <!-- Main Player -->
        <div id="player-container">

            <!-- Album Poster -->
            <div id="album-poster" style="background-image: url('');">
                <div id="lyrics-container">
                    <p id="lyrics-text">Loading lyrics...</p>
                </div>
            </div>

            <!-- Song Info -->
            <div id="song-info">
                <span id="song-name">Song Name</span>
                <span id="song-artist">Artist Name</span>
                <span id="album-name">Album Name</span>
            </div>

            <!-- Song List Dropdown -->
            <select id="song-list" onchange="playSong()">
                <option value="">Select a song</option>
            </select>

            <!-- Controls -->
            <div id="controls">
                <button id="prev" onclick="prevSong()">
                    <i class="material-icons">skip_previous</i>
                </button>
                <button id="play" onclick="togglePlay()">
                    <i class="material-icons" id="play-icon">play_arrow</i>
                </button>
                <button id="next" onclick="nextSong()">
                    <i class="material-icons">skip_next</i>
                </button>
                <!-- Shuffle Button -->
                <button id="shuffle-btn" onclick="shufflePlaylist()">
                    <i class="material-icons">shuffle</i>
                </button>
                <!-- Download Button -->
                <button id="download-btn" onclick="downloadSong()">
                    <i class="material-icons">file_download</i>
                </button>
            </div>

            <!-- Progress Bar -->
            <input type="range" id="progress-bar" value="0" max="100" onchange="seekSong()" />
            <span id="time-display">0:00</span>

            <!-- Quality Dropdown -->
            <select id="quality-select" onchange="changeQuality()">
                <option value="12">Low Quality (12 kbps)</option>
                <option value="48">Medium Quality (48 kbps)</option>
                <option value="96" selected>High Quality (96 kbps)</option>
                <option value="160">Very High Quality (160 kbps)</option>
                <option value="320">Ultra High Quality (320 kbps)</option>
            </select>

        </div>

    </div>

    <!-- Audio Player (Hidden) -->
    <audio id="audio" controls></audio>

    <script>
        const queries = [
            'Telugu', 'SBP', 'Devi Sri Prasad', 'Mani Sharma', 'love', 'Anoop Rubens',
            'S. P. Balasubrahmanyam', 'Ilaiyaraaja', 'K.J. Yesudas', 'M. M. Keeravani',
            'Annamayya Keerthana', 'G.V. Prakash Kumar', 'Anurag Kulkarni', 'Mahesh Babu',
            'Thaman S', 'Ram Miriyala', 'Bheems Ceciroleo', 'Yuvan Shankar Raja',
            'Ramajogayya Sastry', 'new remix'
        ];

        let audio = document.getElementById("audio");
        let playIcon = document.getElementById("play-icon");
        let songList = document.getElementById("song-list");
        let progressBar = document.getElementById("progress-bar");
        let timeDisplay = document.getElementById("time-display");
        let qualitySelect = document.getElementById("quality-select");
        let currentSongIndex = 0;
        let songs = []; // Store song data from API response
        let currentQuality = "96"; // Default to 96 kbps

        // Auto-fetch random query and play the first song on page load
        window.onload = async function () {
            const randomQuery = queries[Math.floor(Math.random() * queries.length)];
            await searchSongs(randomQuery);
            document.getElementById("loader").classList.add('hide-loader');
            document.getElementById("content").classList.remove('hide-loader');
        };

        // Fetch songs based on search query
        async function searchSongs(query) {
            if (!query) return;

            let url = `https://saavn.dev/api/search/songs?query=${query}&page=1&limit=50`;
            const response = await fetch(url);
            const data = await response.json();
            songs = data.data.results;
            updateSongList();
        }

        // Fetch lyrics for the song
        async function fetchLyrics(songId) {
            const url = `https://saavn.dev/api/songs/${songId}/lyrics`;
            const response = await fetch(url);
            const data = await response.json();

            const lyricsContainer = document.getElementById("lyrics-container");
            const lyricsText = document.getElementById("lyrics-text");

            if (data.data) {
                const lyrics = data.data.lyrics.split('\n');
                let formattedLyrics = lyrics.map(line => `<p class="lyrics-line">${line}</p>`).join('');
                lyricsText.innerHTML = formattedLyrics;
                lyricsContainer.style.display = 'block';
            } else {
                lyricsText.innerText = 'Lyrics not available.';
                lyricsContainer.style.display = 'none';
            }
        }

        // Update song list dropdown
        function updateSongList() {
            songList.innerHTML = "<option value=''>Select a song</option>";
            songs.forEach((song, index) => {
                const option = document.createElement("option");
                option.value = index;
                option.innerHTML = song.name;
                songList.appendChild(option);
            });

            if (songs.length > 0) {
                currentSongIndex = 0;
                loadSong();
                audio.play();
            }
        }

        // Play selected song
        function playSong() {
            if (songList.value !== "") {
                currentSongIndex = songList.value;
                loadSong();
                audio.play();
            }
        }

        // Load song info
        function loadSong() {
            const song = songs[currentSongIndex];
            const selectedQuality = qualitySelect.value;
            const qualityUrl = song.downloadUrl.find(url => url.quality === `${selectedQuality}kbps`).url;

            audio.src = qualityUrl;
            document.getElementById("song-name").innerText = song.name;
            document.getElementById("song-artist").innerText = song.artists.primary[0].name;
            document.getElementById("album-name").innerText = song.album.name;
            document.getElementById("album-poster").style.backgroundImage = `url(${song.image[2].url})`;
            playIcon.innerText = "pause";

            // Fetch lyrics
            fetchLyrics(song.id);
        }

        // Toggle play/pause
        function togglePlay() {
            if (audio.paused) {
                audio.play();
                playIcon.innerText = "pause";
            } else {
                audio.pause();
                playIcon.innerText = "play_arrow";
            }
        }

        // Seek song based on progress bar
        function seekSong() {
            const seekTo = audio.duration * (progressBar.value / 100);
            audio.currentTime = seekTo;
        }

        // Update progress bar as song plays
        audio.ontimeupdate = function () {
            let progress = (audio.currentTime / audio.duration) * 100;
            progressBar.value = progress;
            let minutes = Math.floor(audio.currentTime / 60);
            let seconds = Math.floor(audio.currentTime % 60);
            timeDisplay.innerText = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
        };

        // Switch audio quality
        function changeQuality() {
            if (audio.src) {
                loadSong();
                audio.play();
            }
        }

        // Previous song
        function prevSong() {
            currentSongIndex = (currentSongIndex - 1 + songs.length) % songs.length;
            loadSong();
            audio.play();
        }

        // Next song
        function nextSong() {
            currentSongIndex = (currentSongIndex + 1) % songs.length;
            loadSong();
            audio.play();
        }

        // Shuffle playlist
        function shufflePlaylist() {
            songs.sort(() => Math.random() - 0.5);
            updateSongList();
        }

        // Download song
        function downloadSong() {
            const song = songs[currentSongIndex];
            const selectedQuality = qualitySelect.value;
            const qualityUrl = song.downloadUrl.find(url => url.quality === `${selectedQuality}kbps`).url;
            window.open(qualityUrl);
        }
    </script>

</body>
</html>
